<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Сверточные нейронные сети для графов. Часть 1 | My deep learning</title>
<meta name="generator" content="Jekyll v3.8.7" />
<meta property="og:title" content="Сверточные нейронные сети для графов. Часть 1" />
<meta name="author" content="Klepikov Konstantin" />
<meta property="og:locale" content="ru_RU" />
<meta name="description" content="Графовые нейронные сети — молодое и перспективное направление развития нейронных сетей, нашедшее применение в анализе различных структур данных, например, социальных профилей, групп документов, в молекулярной биологии, трехмерных изображений и т.д. и т.п. В данной статье разбираются подходы к решению проблемы работы с графовыми данными." />
<meta property="og:description" content="Графовые нейронные сети — молодое и перспективное направление развития нейронных сетей, нашедшее применение в анализе различных структур данных, например, социальных профилей, групп документов, в молекулярной биологии, трехмерных изображений и т.д. и т.п. В данной статье разбираются подходы к решению проблемы работы с графовыми данными." />
<link rel="canonical" href="https://konstantinklepikov.github.io/2020/10/19/svertochnie-neyronnie-seti-dlja-grafov-chast-1.html" />
<meta property="og:url" content="https://konstantinklepikov.github.io/2020/10/19/svertochnie-neyronnie-seti-dlja-grafov-chast-1.html" />
<meta property="og:site_name" content="My deep learning" />
<meta property="og:image" content="https://konstantinklepikov.github.io/assets/img/191020banner.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-10-19T00:00:00+02:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","image":"https://konstantinklepikov.github.io/assets/img/191020banner.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://konstantinklepikov.github.io/2020/10/19/svertochnie-neyronnie-seti-dlja-grafov-chast-1.html"},"datePublished":"2020-10-19T00:00:00+02:00","author":{"@type":"Person","name":"Klepikov Konstantin"},"url":"https://konstantinklepikov.github.io/2020/10/19/svertochnie-neyronnie-seti-dlja-grafov-chast-1.html","description":"Графовые нейронные сети — молодое и перспективное направление развития нейронных сетей, нашедшее применение в анализе различных структур данных, например, социальных профилей, групп документов, в молекулярной биологии, трехмерных изображений и т.д. и т.п. В данной статье разбираются подходы к решению проблемы работы с графовыми данными.","headline":"Сверточные нейронные сети для графов. Часть 1","dateModified":"2020-10-19T00:00:00+02:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="keywords" content="Сверточная нейронная сеть граф graph convolutional neural network GCN">

  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="icon" href="/assets/img/favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="/assets/img/favicon.ico" type="image/x-icon">

  
  
  <link rel="stylesheet" href="https://konstantinklepikov.github.io/assets/style.css">

  
      <!-- Yandex.Metrika counter -->
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(53548570, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true
    });
  </script>
  <noscript><div><img src="https://mc.yandex.ru/watch/53548570" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->
      <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-139620627-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-139620627-1');
  </script>
    <script data-ad-client="ca-pub-2809667403284871" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  

  <link rel="canonical" href="https://konstantinklepikov.github.io/2020/10/19/svertochnie-neyronnie-seti-dlja-grafov-chast-1.html">
  <link rel="alternate" type="application/rss+xml" title="My deep learning" href="https://konstantinklepikov.github.io/feed.xml">

  <script async defer src="https://buttons.github.io/buttons.js"></script>

  <!-- Mathjax Support -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
</script>
  
  
    





  
</head>


  <body>

    <header class="border-bottom-thick px-2 clearfix">
  <div class="left sm-width-full py-1 mt-1 mt-lg-0">
    <a class="align-middle link-primary text-accent" href="/">
      My deep learning
    </a>
  </div>
  <div class="right sm-width-full">
    <ul class="list-reset mt-lg-1 mb-2 mb-lg-1">
      
        
      
        
      
        
      
        
      
        
        <li class="inline-block">
          <a class="align-middle link-primary mr-2 mr-lg-0 ml-lg-2" href="/about/">
            Об авторе
          </a>
        </li>
        
      
        
      
        
        <li class="inline-block">
          <a class="align-middle link-primary mr-2 mr-lg-0 ml-lg-2" href="/allposts/">
            Все посты
          </a>
        </li>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
        <li class="inline-block">
          <a class="align-middle link-primary mr-2 mr-lg-0 ml-lg-2" href="/links/">
            Ссылки
          </a>
        </li>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    </ul>
  </div>
</header>


    <div>
      <article class="container px-2 mx-auto mb4" itemscope itemtype="http://schema.org/BlogPosting">
  <h1 class="h1 col-9 sm-width-full py-4 mt-3 inline-block" itemprop="name headline">Сверточные нейронные сети для графов. Часть 1</h1>
  <div class="col-4 sm-width-full mt-1 border-top-thin">
    <p class="py-2 bold h4"><time datetime="2020-10-19T00:00:00+02:00" itemprop="datePublished">Oct 19, 2020</time></p>
    <p class="mb-3 h5">Теги: 
    
      
      <a href="/tag/neural-network" title="neural-network" class="link-tags">neural-network&nbsp;</a>
    
      
      <a href="/tag/graphs" title="graphs" class="link-tags">graphs&nbsp;</a>
    
      
      <a href="/tag/convolutional" title="convolutional" class="link-tags">convolutional&nbsp;</a>
    
      
      <a href="/tag/cs224w" title="cs224w" class="link-tags">cs224w&nbsp;</a>
    
      
      <a href="/tag/GCN" title="GCN" class="link-tags">GCN&nbsp;</a>
    
    </p>
  </div>

  <div class="prose" itemprop="articleBody">
      <p>Графовые нейронные сети — молодое и перспективное направление развития нейронных сетей, нашедшее применение в анализе различных структур данных, например, социальных профилей, групп документов, в молекулярной биологии, трехмерных изображений и т.д. и т.п. В данной статье разбираются подходы к решению проблемы работы с графовыми данными.</p>

<p>Проблемой обучения моделей на данных, представленных в виде графов, является их плохая структурированность. Информация о нодах и связях между ними описывается, как правило, в многомерном неевклидовом пространстве, что делает векторизацию таких данных затруднительной.</p>

<p>Одним из основных подходов в решении данной задачи является representation learning. Подход сводится к созданию эмбеддингов для нод или субграфов в графе, что позволяет перевести данные в область с низкой размерностью. Такие эмбеддинги уже можно использовать на входе различных моделей ML.</p>

<p>Если мы имеем граф <script type="math/tex">G = (V, E)</script> и ассоциированные с ним матрицу смежности <script type="math/tex">A</script> и матрицу <script type="math/tex">X</script>, содержащую атрибуты нод, так что <script type="math/tex">X \in \mathbb{R}^{m \times \vert V \vert}</script>, то задачей является получение векторов <script type="math/tex">z \in \mathbb{R}^d</script> для каждой ноды, таких, что <script type="math/tex">d \ll \vert V \vert</script>. (Данный подход справедлив и для ребер).</p>

<p>Эту задачу решает такая модель:</p>

<ul>
  <li>функция похожести <script type="math/tex">S_g : V \times V \rightarrow \mathbb{R}^+</script>, определенная над графом <script type="math/tex">G</script>. Функция измеряет схожесть между нодами.</li>
  <li>энкодер, генерирующий эмбеддинги</li>
  <li>декодер, реконструирующий взаимную схожесть нод</li>
  <li>функция потерь</li>
</ul>

<p>Самый простой метод — shallow encoding, для которого мы можем определить энкодер как функцию: <script type="math/tex">ENC(v_i) = Z v_i</script>, где <script type="math/tex">Z \in \mathbb{R}^{m \times \vert V \vert}</script>.</p>

<p>К подобным методам относятся различные матричные факторизации (graph factorisation, GraRep, HOPE и т.д.) и RandomWalk модели (DeepWalk, node2wec).</p>

<p>Проблемой shallow encoding является то, что в этом методе параметры нод не распространяются в энкодере. Каждый вектор обучается отдельно от других, что ведет к значительному росту сложности. Кроме того, подход не учитывает атрибуты нод, которые в большинстве случаев содержат важную информацию о графе. К тому же подход генерирует эмбеддинги только для данных, которые есть среди обучаемых. Модель проблематично обобщить на данные, которые модель никогда не видела.</p>

<p>Чтобы справиться с недостатками shallow encoding, были изобретены генерализованные энкодер-декодер структуры: DNGR (deep neural graph representation) и SDNE (structural deep network embeddings), относящихся к автоэнкодерам, основанных на исследовании соседних нод в графе.</p>

<p>Прямым решением для таких моделей является то, что каждая нода <script type="math/tex">v_i</script> ассоциируется с высокаразмерным «вектором близости» <script type="math/tex">S_i \in \mathbb{R}^{\vert V \vert}</script>, содержащем информацию о близости ноды ко всем другим нодам в графе. Затем данный вектор сжимается до нужной размерности. Проблема такого подхода в том, что он невероятно дорогой. К тому же метод статичный и плохо работает с изменяющимися графами.</p>

<p>Другой подход — neighbourhood agregation атрибутов нод для генерации эмбеддингов. Этот метод позволяет агрегировать «месседжи» от соседей ноды, которые, в свою очередь, базируются на «месседжах», агрегированных по соседям соседей и т.д. Иногда такие модели называют сверточными энкодерами из-за схожести их архитектуры со свертками.</p>

<p><img src="../../../assets/img/191020-01.png" alt="neighbourhood agregation" /></p>

<p>Алгоритм такой сети выглядит так (взято из статьи Representation Learning on Graphs: Methods and Applicationsб Hamilton, William L.; Ying, Rex; Leskovec, Jure);</p>

<p><img src="../../../assets/img/191020-02.png" alt="neighbourhood agregation algorythm" /></p>

<p>Алгоритм строит эмбеддинги для нод рекурсивно. Вначале модель инициализируется входными данными, эквивалентными атрибутам нод. Затем на каждой итерации алгоритма под управлением некой дифференцирующей агрегирующей функции агрегируются эмбеддинги соседей. Затем каждая нода получает новый эмбеддинг, скомбинированный из ее собственного эмбеддинга и агрегированного вектора. Затем все это отправляется в полносвязный слой и затем процесс повторяется <script type="math/tex">K</script>раз.</p>

<p>К моделям, которые работают по такому принципу относятся многочисленное семейство GCN (graph convolutional networks), column networks и GraphSAGE.</p>

<p>В алгоритме обучаются агрегирующие функции и сет матриц весов <script type="math/tex">\{W^K, \forall \mathbb{R} \in [ 1, K ]\}</script>, которые и определяют как именно агрегируется информация из области локальной близости ноды. Эти параметры распространяются соседним нодам.</p>

<p>Разные подтипы модели определяются разными агрегирующей функцией (стр.4 алгоритма) и комбинирующей вектора функцией (стр.5). В GCN и columns encoding используется взвешенная сумма в качестве комбинирующей функции и поэлементное среднее для агрегирующей. В GraphSAGE используется конкатенация в качестве комбинирующей функции, а в качестве агрегирующей может использоваться другая нейронная сеть, к примеру, LSTM.</p>

  </div>
  
    <div id="share-bar">

    <h4>Поделиться статьей</h4>

    <div class="share-buttons">
        <a href="https://www.facebook.com/sharer/sharer.php?u=https://konstantinklepikov.github.io/2020/10/19/svertochnie-neyronnie-seti-dlja-grafov-chast-1.html&title=Сверточные нейронные сети для графов. Часть 1" nclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Поделиться на Facebook" class="link-primary" target="_blank" rel="noopener">
            <i class="fa fa-facebook-official share-button"> facebook</i>
        </a>

        <a href="https://twitter.com/intent/tweet?text=Сверточные нейронные сети для графов. Часть 1&url=https://konstantinklepikov.github.io/2020/10/19/svertochnie-neyronnie-seti-dlja-grafov-chast-1.html" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Поделиться на Twitter" class="link-primary" target="_blank" rel="noopener">
            <i class="fa fa-twitter share-button"> twitter</i>
        </a>

        <a href="https://vk.com/share.php?url=https://konstantinklepikov.github.io/2020/10/19/svertochnie-neyronnie-seti-dlja-grafov-chast-1.html&title=Сверточные нейронные сети для графов. Часть 1" title="Поделиться в vkontakte" class="link-primary" target="_blank" rel="noopener">
            <i class="fa fa-vk share-button"> vkontakte</i>
        </a>

        <a  href="mailto:?subject=Сверточные нейронные сети для графов. Часть 1&body=Check out this site https://konstantinklepikov.github.io/2020/10/19/svertochnie-neyronnie-seti-dlja-grafov-chast-1.html"
        title="Отправить по почте" >
        <i class="fa fa-envelope share-button"> email</i>
    </a>
    </div>

</div>
    <script src="https://utteranc.es/client.js"
        repo="KonstantinKlepikov/KonstantinKlepikov.github.io"
        issue-term="url"
        label="blog-comments"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
  

  <p class="h4 mt-2">Все статьи с тегом <a href="/tag/GCN" class="link-tags">GCN</a></p>
  <div class="prose mb-2">
    <ul>
        
        <li><a href="/2020/10/19/svertochnie-neyronnie-seti-dlja-grafov-chast-1.html" title="Сверточные нейронные сети для графов. Часть 1">Сверточные нейронные сети для графов. Часть 1</a> (19 Oct 2020)<br>
            
        </li>
        
    </ul>
  </div>

</article>

<div class="container mx-auto px-2 py-2 clearfix">
  <!-- Use if you want to show previous and next for all posts. -->



  <div class="col-4 sm-width-full left mr-lg-4 mt-3">
    <a class="no-underline border-top-thin py-1 block" href="https://konstantinklepikov.github.io/2020/10/09/breadth-first-and-depth-first-search-algorithms.html" title="Алгоритмы поиска в ширину и в глубину">
      <span class="h5 link-secondary text-accent">Предыдущая запись</span>
      <p class="bold h3 link-primary mb-1">Алгоритмы поиска в ширину и в глубину</p>
      <p>Поиск в ширину и поиск в глубину представляют две основных парадигмы обхода графов. Поиск в ширину (breadth-first search, BFS) Алгоритм...</p>
    </a>
  </div>
  
  

</div>

    </div>

    <div class="border-top-thin clearfix mt-2 mt-lg-4">
  <div class="container mx-auto px-2">
    <p class="col-8 sm-width-full left py-2 mb-0">Этот проект поддерживается <a class="text-accent" href="https://github.com/KonstantinKlepikov">KonstantinKlepikov</a></p>
    <ul class="list-reset right clearfix sm-width-full py-2 mb-2 mb-lg-0">
      <li class="inline-block mr-1">
        <a href="https://twitter.com/share" class="twitter-share-button" data-hashtags="My deep learning">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
      </li>
      <li class="inline-block">
        <a class="github-button" href="https://github.com/KonstantinKlepikov/" data-icon="octicon-star" data-count-href="KonstantinKlepikov//stargazers" data-count-api="/repos/KonstantinKlepikov/#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star KonstantinKlepikov/ on GitHub">Star</a>
      </li>
    </ul>
  </div>
</div>


  </body>

</html>
